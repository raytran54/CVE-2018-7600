# CVE-2018-7600

## Table of contents:
1. [CVE summary](#CVE-summary)
2. [Prerequisites](#Prerequisites)
3. [CVE Analyse](#CVE-Analyse)
## CVE summary
- An attacker could call a Drupal Form API Ajax Request containing the call_user_func auto do function
- Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1
## Prerequisites
- In this lab, I use:
  
   * Ubuntu 20.04
   * PHP 7.2
   * MariaDB
   * The Drupal version I use in this lab is 8.3.8

## CVE Analyse

- We find the keys that use call_user_func are #pre_render, #post_render, #access_callback, #submit, #lazy_builder, #validate
![image](https://github.com/raytran54/CVE-2018-7600/assets/89938940/320b972a-4984-443a-8498-7193001bf8ee)
The task now is to find which param the user submitted has a render, can change the key, and receive the #post_render key, to call him out.
![image](https://github.com/raytran54/CVE-2018-7600/assets/89938940/e975d4d5-f61e-45f6-874b-ca86600b5267)
When resizing the picture server call drupal API
![image](https://github.com/raytran54/CVE-2018-7600/assets/89938940/82378e8c-93ed-4eb0-876c-23790e6c8205)


